<%# app/views/repositories/index.html.erb %>


<div style="width: 80%; background: #f0f0f0; padding: 30px;">
  
  <h1 style="text-align: center; color: #333; margin-bottom: 30px;">Le mie Repository</h1>
  
  <table style="width: 100%; margin: 0 auto;">
    <% @repositories.each_slice(3) do |repo_row| %>
      <tr>
        <% repo_row.each do |repo| %>
          <td style="width: 33%; padding: 15px; vertical-align: top;">
            
            <div style="background: white; padding: 20px; border: 1px solid #ddd; margin-bottom: 20px;">
              
              <h3 style="color: #333; margin-bottom: 10px;">
                <i class="fa-brands fa-github"></i> <%= repo[:title] %>
              </h3>
              
              <% if repo[:archived] %>
                <span style="background: orange; color: white; padding: 3px 8px; font-size: 12px;">ARCHIVIATO</span>
              <% else %>
                <span style="background: green; color: white; padding: 3px 8px; font-size: 12px;">ATTIVO</span>
              <% end %>
              
              <p style="color: #666; margin: 15px 0; font-size: 14px;">
                <%= truncate(repo[:description], length: 80) %>
              </p>
              
              <div style="font-size: 12px; color: #999; margin-bottom: 15px;">
                Ultimo commit: <%= repo[:last_commit_at]%> fa<br>
                Creato: <%= repo[:created_at].strftime("%b %Y") %>
              </div>
              
              <div style="text-align: center;">
                <button style="margin-right: 10px; background: none; border: none; font-size: 16px; color: #ccc;">
                  <i class="fa-regular fa-heart"></i>
                </button>
                <button style="margin-right: 10px; background: none; border: none; font-size: 16px; color: #ccc;">
                  <i class="fa-regular fa-bookmark"></i>
                </button>
                <a href="<%= repo[:url] %>" target="_blank" style="margin-right: 10px; color: #ccc;">
                  <i class="fa-solid fa-external-link"></i>
                </a>
                
                <br><br>
                
                <%= link_to repository_path(repo[:id]), 
                    style: "background: black; color: white; padding: 8px 15px; text-decoration: none;" do %>
                  Show Repo
                <% end %>
              </div>
              
            </div>
            
          </td>
        <% end %>
        
        <!-- Riempi celle vuote se l'ultima riga ha meno di 3 elementi -->
        <% (3 - repo_row.length).times do %>
          <td style="width: 33%; padding: 15px;"></td>
        <% end %>
      </tr>
    <% end %>
  </table>
  
  <% if @repositories.empty? %>
    <div style="text-align: center; background: white; padding: 40px; border: 1px solid #ddd;">
      <h3>Nessuna repository trovata</h3>
      <p>Aggiungi la tua prima repository</p>
      <%= link_to "Aggiungi Repository", new_repository_path, 
            style: "display: inline-block; margin-top: 15px; background: black; color: white; padding: 10px 20px; text-decoration: none;" %>
    </div>
  <% end %>
  
</div>